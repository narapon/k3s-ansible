---
k3s_server_location: /var/lib/rancher/k3s
ansible_user: root
# server_init_args: >-
#   {% if groups['master'] | length > 1 %}
#     {% if ansible_host == hostvars[groups['master'][0]]['ansible_host'] | default(groups['master'][0]) %}
#       --cluster-init
#     {% else %}
#       --server https://{{ apiserver_endpoint }}:6443
#     {% endif %}
#     --token {{ k3s_token }}
#   {% endif %}
#   {{ extra_server_args | default('') }}

# server_init_args: >-
#   {% if groups['master'] | length > 1 %}
#     --server https://{{ apiserver_endpoint }}:6443
#     --token {{ k3s_token }}
#   {% endif %}
#   {{ extra_server_args | default('') }}

# for recovering first node
server_init_args: >-
  {% if groups['master'] | length > 1 %}
    {% if ansible_hostname == hostvars[groups['master'][0]]['ansible_hostname'] %}
      --server https://{{ apiserver_endpoint }}:6443
    {% else %}
      --server https://{{ apiserver_endpoint }}:6443
    {% endif %}
    --token {{ k3s_token }}
  {% endif %}
  {{ extra_server_args | default('') }}

# server_init_args: >-
#   {% if groups['master'] | length > 1 %}
#     {% if ansible_hostname == hostvars[groups['master'][0]]['ansible_hostname'] %}
#       --cluster-init
#     {% else %}
#       --server https://{{ apiserver_endpoint }}:6443
#     {% endif %}
#     --token {{ k3s_token }}
#   {% endif %}
#   {{ extra_server_args | default('') }}